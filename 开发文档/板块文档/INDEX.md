# 🎨 板块设计文档层 (板块文档/)

> **职责**: 记录各业务板块的设计方案、指标定义、UI规范
> **更新时间**: 2026-01-02
> **维护规则**: 新增板块必须创建对应文档；指标口径变更必须先修改此层

---

## 📖 目录职责

本目录按业务板块组织，记录车险经营分析系统的所有板块设计、指标体系、UI/UX规范。是业务需求到技术实现的桥梁。

---

## 🔑 板块清单（按编号排序）

| 编号 | 板块名称 | 文档路径 | 核心内容 | 关联功能 | 关联代码 |
|------|---------|---------|---------|---------|---------|
| **00** | UI设计规范 | [00_UI设计.md](./00_UI设计.md) | 配色方案、布局规范、交互模式 | F008, F009 | `css/dashboard.css` |
| **01** | 指标体系 | [01_指标体系.md](./01_指标体系.md) | KPI定义、计算公式、阈值规则 | F003 | `js/data.worker.js:244-309`, `reference/thresholds.json` |
| **02** | 经营概览板块 | [02_经营概览板块.md](./02_经营概览板块.md) | 总览仪表盘、KPI卡片设计 | F008 | `js/dashboard.js:82-200` |
| **03** | 保费进度板块 | [03_保费进度板块.md](./03_保费进度板块.md) | 保费分析、进度率计算 | F003, F008 | `js/dashboard.js`, `reference/year-plans.json` |
| **04** | 变动成本板块 | [04_变动成本板块.md](./04_变动成本板块.md) | 成本分析、赔付率、费用率 | F003, F008 | `js/dashboard.js:404-616` |
| **05** | 损失暴露板块 | [05_损失暴露板块.md](./05_损失暴露板块.md) | 损失分析、赔付频度、案均赔款 | F003, F008 | `js/dashboard.js` |
| **06** | 费用支出板块 | [06_费用支出板块.md](./06_费用支出板块.md) | 费用分析、投产比 | F003, F008 | `js/dashboard.js` |
| **07** | 筛选器系统 | [07_筛选器系统.md](./07_筛选器系统.md) | 电商式下拉筛选、时间筛选 | F007, F008 | `js/dashboard.js:1496-1600` |

---

## 📂 按类型分类

### 基础规范类
- **00_UI设计.md**: 全局UI/UX设计规范
- **01_指标体系.md**: 指标定义与计算规则

### 业务分析板块类
- **02_经营概览板块.md**: 总览仪表盘
- **03_保费进度板块.md**: 保费分析
- **04_变动成本板块.md**: 成本分析
- **05_损失暴露板块.md**: 损失分析
- **06_费用支出板块.md**: 费用分析

### 交互组件类
- **07_筛选器系统.md**: 筛选器设计与实现

---

## 📖 核心板块详解

### 00_UI设计.md（全局设计规范）

**核心内容**:
- 配色规范（主题色、状态色、维度色）
- 布局规范（栅格系统、间距规范）
- 交互模式（悬浮提示、点击交互）
- 术语规范（满期赔付率 VS 赔款贡献度）

**关联资源**:
- CSS实现: `css/dashboard.css`
- 配色变量: `--primary-red: #a02724`, `--warning-yellow: #ffc000`, `--success-green: #00b050`
- 维度颜色映射: `js/dashboard.js:1978-1987`

**关键决策**:
- 采用麦肯锡式专业风格（简洁、数据驱动）
- 主题色选择红色（`#a02724`）契合保险行业风格

---

### 01_指标体系.md（唯一事实来源）

**核心内容**:
- KPI定义（满期赔付率、费用率、变动成本率等）
- 计算公式（详细的数学公式与字段映射）
- 阈值规则（良好/警告/危险边界）
- 数据字典（字段名称、含义、单位）

**关联资源**:
- 阈值配置: `reference/thresholds.json`
- 计算实现: `js/data.worker.js:244-309`
- 年度计划: `reference/year-plans.json`

**⚠️ 变更协议**:
- 修改指标口径必须先修改本文档
- 修改后必须同步更新 `reference/thresholds.json`
- 必须创建ADR记录变更决策

**关键公式**:
```
变动成本率 = 满期赔付率 + 费用率
满期赔付率 = (已报告赔款 / 满期保费) × 100
费用率 = (费用额 / 签单保费) × 100
赔付频度 = (赔案件数 / 保单件数) × 100
保费进度率 = (实际保费 / 计划保费) × 100
```

---

### 02_经营概览板块.md（总览仪表盘）

**核心内容**:
- KPI卡片布局（4×2网格）
- KPI卡片内容（标题、数值、状态）
- 状态判定逻辑（良好/警告/危险）

**关联功能**:
- [F008 - 交互式数据可视化仪表盘](../01_features/F008_dashboard_visualization/README.md)

**关联代码**:
- KPI渲染: `js/dashboard.js:82-200`
- 状态判定: 基于 `reference/thresholds.json`

---

### 03-06_各业务板块.md（分析板块）

**共同结构**:
1. **板块定位**：业务目标与分析视角
2. **核心指标**：本板块关注的KPI列表
3. **图表设计**：图表类型、配色、预警线
4. **数据来源**：字段映射与计算逻辑
5. **交互设计**：筛选联动、下钻路径

**差异化内容**:
- **保费进度板块**: 关注保费达成率、时间进度对比
- **变动成本板块**: 关注赔付率+费用率双维度
- **损失暴露板块**: 关注频度×强度分析
- **费用支出板块**: 关注投产比、费用结构

---

### 07_筛选器系统.md（核心交互）

**核心内容**:
- 电商式下拉筛选设计理念
- 筛选器状态管理（Draft → Applied）
- 多维度筛选逻辑（AND/OR关系）
- 时间筛选器设计

**关键设计**:
- **批量选择→一次应用**：类似淘宝/京东商品筛选
- **草稿与已应用分离**：避免误触发数据重算
- **多维度间AND，同维度内OR**：`(机构A OR 机构B) AND (客户类别C OR 客户类别D)`

**关联功能**:
- [F007 - 智能元数据提取](../01_features/F007_metadata_extraction/README.md)
- [F008 - 交互式数据可视化仪表盘](../01_features/F008_dashboard_visualization/README.md)

**关联代码**:
- 维度配置: `js/dashboard.js:1496-1507`
- 筛选逻辑: `js/dashboard.js:1500-1600`
- 维度映射: `js/data.worker.js:524-532`

---

## 🔗 与其他层的关联

### 功能文档关联（/开发文档/01_features）
- **01_指标体系** ↔ [F003 - KPI计算引擎](../01_features/F003_kpi_calculation/README.md)
- **07_筛选器系统** ↔ [F007 - 智能元数据提取](../01_features/F007_metadata_extraction/README.md)
- **02-06各板块** ↔ [F008 - 交互式数据可视化仪表盘](../01_features/F008_dashboard_visualization/README.md)

### 代码关联（/js, /reference, /css）
- **指标体系** → `reference/thresholds.json`, `js/data.worker.js`
- **UI设计** → `css/dashboard.css`
- **筛选器系统** → `js/dashboard.js`

### 决策记录关联（/开发文档/decisions）
- **UI设计** ↔ [D001 - ECharts-CDN加载优化](../decisions/D001_ECharts-CDN加载优化.md)
- **变动成本板块、损失暴露板块** ↔ [D003 - 图表优化与损失暴露分析](../decisions/D003_图表优化与损失暴露分析.md)

---

## 🔄 变更协议

### 必须更新索引的场景

1. **新增板块**
   - 创建 `XX_板块名称.md`（XX为下一个可用编号）
   - 在本INDEX.md的"板块清单"表格中新增一行
   - 更新"按类型分类"章节
   - 更新 [DOC_INDEX.md](../00_index/DOC_INDEX.md)

2. **修改指标口径**（最高优先级）
   - 必须先修改 `01_指标体系.md`
   - 同步修改 `reference/thresholds.json`
   - 创建ADR记录决策过程
   - 更新相关板块文档（如保费进度、变动成本等）
   - 更新代码实现（`js/data.worker.js`）

3. **修改UI规范**
   - 修改 `00_UI设计.md`
   - 同步修改 `css/dashboard.css`
   - 更新相关板块文档（如使用新配色）

4. **修改板块设计**
   - 修改对应板块文档
   - 如涉及新增KPI，必须先更新 `01_指标体系.md`
   - 更新关联功能文档（`/开发文档/01_features/`）

---

## 📌 维护注意事项

- **编号连续性**：板块编号必须连续，不得跳号
- **指标体系优先**：修改指标口径必须先修改 `01_指标体系.md`
- **UI规范统一**：所有板块必须遵循 `00_UI设计.md` 的规范
- **强制互链**：每个板块文档必须链接到关联的功能文档和代码位置

---

**全局文档索引**: [DOC_INDEX.md](../00_index/DOC_INDEX.md)
**指标体系详解**: [01_指标体系.md](./01_指标体系.md)
**最后更新**: 2026-01-02
**维护者**: autowrKPI Governance Team
